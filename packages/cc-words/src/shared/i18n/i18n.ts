// RTL (right-to-left) languages
export const rtlLanguages = ["ar", "iw", "fa", "ur", "ps", "sd", "ug", "yi"];

// Check if a language code is RTL
export function isRtlLanguage(langCode: string): boolean {
  const baseLang = langCode.split("-")[0].split("_")[0];
  return rtlLanguages.includes(baseLang);
}

export const messages = {
  en: {
    word_selection: "Word Selection",
    word_selection_sub: "Translate and save words on YouTube",
    all_sites_selection: "Enable on All Sites",
    all_sites_selection_sub: "Use word selection beyond YouTube",
    view_words: "My Words",
    view_words_sub: "Review and manage saved words",
    target_language: "Target Language",
    target_language_sub: "Language you are learning",
    my_language: "My Language",
    my_language_sub: "Your native language",
    save_word: "Save",
    translation_loading: "Translating...",
    translation_error: "Translation failed",
    word_saved: "Word saved",
    retry: "Retry",
    refresh_page: "Refresh",
    extension_updated: "Extension updated, please refresh",
    account: "Account",
    sign_in: "Sign in",
    sign_in_google: "Sign in with Google",
    sign_out: "Sign out",
    sync_now: "Sync now",
    syncing: "Syncing...",
    sync_success: "Synced",
    logged_in_as: "Logged in as",
    anonymous: "Guest",
    search_language: "Search language...",
    no_results: "No results found",
    activity_title: "Learning Activity",
    activity_last_weeks: "Last {weeks} weeks",
    activity_selections: "selections",
    activity_less: "Less",
    activity_more: "More",
    show_activity: "Show Activity Chart",
    show_activity_sub: "Display learning progress heatmap",
  },
  zh_CN: {
    word_selection: "划词翻译",
    word_selection_sub: "在 YouTube 上翻译并保存生词",
    all_sites_selection: "启用全站划词",
    all_sites_selection_sub: "在所有网站上使用划词翻译",
    view_words: "我的生词",
    view_words_sub: "复习和管理已保存的生词",
    target_language: "目标语言",
    target_language_sub: "正在学习的语言",
    my_language: "我的语言",
    my_language_sub: "你的母语",
    save_word: "保存",
    translation_loading: "翻译中...",
    translation_error: "翻译失败",
    word_saved: "已保存",
    retry: "重试",
    refresh_page: "刷新",
    extension_updated: "扩展已更新，请刷新页面",
    account: "账户",
    sign_in: "登录",
    sign_in_google: "使用 Google 登录",
    sign_out: "退出登录",
    sync_now: "立即同步",
    syncing: "同步中...",
    sync_success: "已同步",
    logged_in_as: "已登录为",
    anonymous: "游客",
    search_language: "搜索语言...",
    no_results: "未找到结果",
    activity_title: "学习活跃度",
    activity_last_weeks: "最近 {weeks} 周",
    activity_selections: "次划词",
    activity_less: "少",
    activity_more: "多",
    show_activity: "显示活跃度图表",
    show_activity_sub: "展示学习进度热力图",
  },
  zh_TW: {
    word_selection: "劃詞翻譯",
    word_selection_sub: "在 YouTube 上翻譯並保存生詞",
    all_sites_selection: "啟用全站劃詞",
    all_sites_selection_sub: "在所有網站上使用劃詞翻譯",
    view_words: "我的生詞",
    view_words_sub: "複習和管理已保存的生詞",
    target_language: "目標語言",
    target_language_sub: "正在學習的語言",
    my_language: "我的語言",
    my_language_sub: "你的母語",
    save_word: "保存",
    translation_loading: "翻譯中...",
    translation_error: "翻譯失敗",
    word_saved: "已保存",
    retry: "重試",
    refresh_page: "重新整理",
    extension_updated: "擴充功能已更新，請重新整理頁面",
    account: "帳戶",
    sign_in: "登入",
    sign_in_google: "使用 Google 登入",
    sign_out: "登出",
    sync_now: "立即同步",
    syncing: "同步中...",
    sync_success: "已同步",
    logged_in_as: "已登入為",
    anonymous: "訪客",
    search_language: "搜尋語言...",
    no_results: "未找到結果",
    activity_title: "學習活躍度",
    activity_last_weeks: "最近 {weeks} 週",
    activity_selections: "次劃詞",
    activity_less: "少",
    activity_more: "多",
    show_activity: "顯示活躍度圖表",
    show_activity_sub: "展示學習進度熱力圖",
  },
  ja: {
    word_selection: "選択翻訳",
    word_selection_sub: "YouTubeで単語を翻訳して保存",
    all_sites_selection: "全サイトで有効化",
    all_sites_selection_sub: "すべてのサイトで選択翻訳を使用",
    view_words: "単語帳",
    view_words_sub: "保存した単語を復習・管理",
    target_language: "ターゲット言語",
    target_language_sub: "学習中の言語",
    my_language: "私の言語",
    my_language_sub: "あなたの母国語",
    save_word: "保存",
    translation_loading: "翻訳中...",
    translation_error: "翻訳に失敗しました",
    word_saved: "保存しました",
    retry: "再試行",
    refresh_page: "更新",
    extension_updated: "拡張機能が更新されました。ページを更新してください",
    account: "アカウント",
    sign_in: "ログイン",
    sign_in_google: "Googleでログイン",
    sign_out: "ログアウト",
    sync_now: "今すぐ同期",
    syncing: "同期中...",
    sync_success: "同期しました",
    logged_in_as: "ログイン中",
    anonymous: "ゲスト",
    search_language: "言語を検索...",
    no_results: "結果が見つかりません",
    activity_title: "学習アクティビティ",
    activity_last_weeks: "過去{weeks}週間",
    activity_selections: "回選択",
    activity_less: "少",
    activity_more: "多",
    show_activity: "アクティビティを表示",
    show_activity_sub: "学習進捗ヒートマップを表示",
  },
  ko: {
    word_selection: "선택 번역",
    word_selection_sub: "YouTube에서 단어를 번역하고 저장",
    all_sites_selection: "모든 사이트에서 활성화",
    all_sites_selection_sub: "모든 사이트에서 선택 번역 사용",
    view_words: "내 단어장",
    view_words_sub: "저장된 단어 복습 및 관리",
    target_language: "대상 언어",
    target_language_sub: "학습 중인 언어",
    my_language: "내 언어",
    my_language_sub: "모국어",
    save_word: "저장",
    translation_loading: "번역 중...",
    translation_error: "번역 실패",
    word_saved: "저장됨",
    retry: "다시 시도",
    refresh_page: "새로고침",
    extension_updated:
      "확장 프로그램이 업데이트되었습니다. 페이지를 새로고침하세요",
    account: "계정",
    sign_in: "로그인",
    sign_in_google: "Google로 로그인",
    sign_out: "로그아웃",
    sync_now: "지금 동기화",
    syncing: "동기화 중...",
    sync_success: "동기화됨",
    logged_in_as: "로그인됨",
    anonymous: "게스트",
    search_language: "언어 검색...",
    no_results: "결과 없음",
    activity_title: "학습 활동",
    activity_last_weeks: "최근 {weeks}주",
    activity_selections: "회 선택",
    activity_less: "적음",
    activity_more: "많음",
    show_activity: "활동 차트 표시",
    show_activity_sub: "학습 진도 히트맵 표시",
  },
  hi: {
    word_selection: "शब्द चयन",
    word_selection_sub: "YouTube पर शब्दों का अनुवाद और सहेजें",
    all_sites_selection: "सभी साइटों पर सक्षम करें",
    all_sites_selection_sub: "YouTube के अलावा शब्द चयन का उपयोग करें",
    view_words: "मेरे शब्द",
    view_words_sub: "सहेजे गए शब्दों की समीक्षा और प्रबंधन करें",
    target_language: "लक्ष्य भाषा",
    target_language_sub: "आप जो भाषा सीख रहे हैं",
    my_language: "मेरी भाषा",
    my_language_sub: "आपकी मातृभाषा",
    save_word: "सहेजें",
    translation_loading: "अनुवाद हो रहा है...",
    translation_error: "अनुवाद विफल",
    word_saved: "शब्द सहेजा गया",
    retry: "पुनः प्रयास करें",
    refresh_page: "रीफ्रेश करें",
    extension_updated: "एक्सटेंशन अपडेट हो गया, कृपया पेज रीफ्रेश करें",
    account: "खाता",
    sign_in: "साइन इन करें",
    sign_in_google: "Google से साइन इन करें",
    sign_out: "साइन आउट करें",
    sync_now: "अभी सिंक करें",
    syncing: "सिंक हो रहा है...",
    sync_success: "सिंक हो गया",
    logged_in_as: "इस रूप में लॉग इन",
    anonymous: "अतिथि",
    search_language: "भाषा खोजें...",
    no_results: "कोई परिणाम नहीं मिला",
    activity_title: "सीखने की गतिविधि",
    activity_last_weeks: "पिछले {weeks} सप्ताह",
    activity_selections: "चयन",
    activity_less: "कम",
    activity_more: "अधिक",
    show_activity: "गतिविधि चार्ट दिखाएं",
    show_activity_sub: "सीखने की प्रगति हीटमैप प्रदर्शित करें",
  },
  es: {
    word_selection: "Selección de Palabras",
    word_selection_sub: "Traduce y guarda palabras en YouTube",
    all_sites_selection: "Habilitar en Todos los Sitios",
    all_sites_selection_sub: "Usar selección de palabras fuera de YouTube",
    view_words: "Mis Palabras",
    view_words_sub: "Revisar y gestionar palabras guardadas",
    target_language: "Idioma Objetivo",
    target_language_sub: "Idioma que estás aprendiendo",
    my_language: "Mi Idioma",
    my_language_sub: "Tu idioma nativo",
    save_word: "Guardar",
    translation_loading: "Traduciendo...",
    translation_error: "Error de traducción",
    word_saved: "Palabra guardada",
    retry: "Reintentar",
    refresh_page: "Actualizar",
    extension_updated: "Extensión actualizada, por favor actualice la página",
    account: "Cuenta",
    sign_in: "Iniciar sesión",
    sign_in_google: "Iniciar sesión con Google",
    sign_out: "Cerrar sesión",
    sync_now: "Sincronizar ahora",
    syncing: "Sincronizando...",
    sync_success: "Sincronizado",
    logged_in_as: "Conectado como",
    anonymous: "Invitado",
    search_language: "Buscar idioma...",
    no_results: "No se encontraron resultados",
    activity_title: "Actividad de Aprendizaje",
    activity_last_weeks: "Últimas {weeks} semanas",
    activity_selections: "selecciones",
    activity_less: "Menos",
    activity_more: "Más",
    show_activity: "Mostrar Gráfico de Actividad",
    show_activity_sub: "Mostrar mapa de calor de progreso",
  },
  fr: {
    word_selection: "Sélection de Mots",
    word_selection_sub: "Traduire et sauvegarder des mots sur YouTube",
    all_sites_selection: "Activer sur Tous les Sites",
    all_sites_selection_sub: "Utiliser la sélection de mots au-delà de YouTube",
    view_words: "Mes Mots",
    view_words_sub: "Réviser et gérer les mots sauvegardés",
    target_language: "Langue Cible",
    target_language_sub: "Langue que vous apprenez",
    my_language: "Ma Langue",
    my_language_sub: "Votre langue maternelle",
    save_word: "Sauvegarder",
    translation_loading: "Traduction...",
    translation_error: "Échec de la traduction",
    word_saved: "Mot sauvegardé",
    retry: "Réessayer",
    refresh_page: "Actualiser",
    extension_updated: "Extension mise à jour, veuillez actualiser la page",
    account: "Compte",
    sign_in: "Se connecter",
    sign_in_google: "Se connecter avec Google",
    sign_out: "Se déconnecter",
    sync_now: "Synchroniser maintenant",
    syncing: "Synchronisation...",
    sync_success: "Synchronisé",
    logged_in_as: "Connecté en tant que",
    anonymous: "Invité",
    search_language: "Rechercher une langue...",
    no_results: "Aucun résultat trouvé",
    activity_title: "Activité d'Apprentissage",
    activity_last_weeks: "{weeks} dernières semaines",
    activity_selections: "sélections",
    activity_less: "Moins",
    activity_more: "Plus",
    show_activity: "Afficher le Graphique d'Activité",
    show_activity_sub: "Afficher la carte thermique de progression",
  },
  ar: {
    word_selection: "تحديد الكلمات",
    word_selection_sub: "ترجمة وحفظ الكلمات على YouTube",
    all_sites_selection: "تفعيل على جميع المواقع",
    all_sites_selection_sub: "استخدام تحديد الكلمات خارج YouTube",
    view_words: "كلماتي",
    view_words_sub: "مراجعة وإدارة الكلمات المحفوظة",
    target_language: "اللغة المستهدفة",
    target_language_sub: "اللغة التي تتعلمها",
    my_language: "لغتي",
    my_language_sub: "لغتك الأم",
    save_word: "حفظ",
    translation_loading: "جاري الترجمة...",
    translation_error: "فشلت الترجمة",
    word_saved: "تم حفظ الكلمة",
    retry: "إعادة المحاولة",
    refresh_page: "تحديث",
    extension_updated: "تم تحديث الإضافة، يرجى تحديث الصفحة",
    account: "الحساب",
    sign_in: "تسجيل الدخول",
    sign_in_google: "تسجيل الدخول بـ Google",
    sign_out: "تسجيل الخروج",
    sync_now: "مزامنة الآن",
    syncing: "جاري المزامنة...",
    sync_success: "تمت المزامنة",
    logged_in_as: "مسجل الدخول كـ",
    anonymous: "ضيف",
    search_language: "البحث عن لغة...",
    no_results: "لم يتم العثور على نتائج",
    activity_title: "نشاط التعلم",
    activity_last_weeks: "آخر {weeks} أسابيع",
    activity_selections: "تحديدات",
    activity_less: "أقل",
    activity_more: "أكثر",
    show_activity: "عرض مخطط النشاط",
    show_activity_sub: "عرض خريطة حرارية لتقدم التعلم",
  },
  bn: {
    word_selection: "শব্দ নির্বাচন",
    word_selection_sub: "YouTube এ শব্দ অনুবাদ এবং সংরক্ষণ করুন",
    all_sites_selection: "সমস্ত সাইটে সক্রিয় করুন",
    all_sites_selection_sub: "YouTube এর বাইরে শব্দ নির্বাচন ব্যবহার করুন",
    view_words: "আমার শব্দ",
    view_words_sub: "সংরক্ষিত শব্দ পর্যালোচনা এবং পরিচালনা করুন",
    target_language: "লক্ষ্য ভাষা",
    target_language_sub: "আপনি যে ভাষা শিখছেন",
    my_language: "আমার ভাষা",
    my_language_sub: "আপনার মাতৃভাষা",
    save_word: "সংরক্ষণ করুন",
    translation_loading: "অনুবাদ হচ্ছে...",
    translation_error: "অনুবাদ ব্যর্থ",
    word_saved: "শব্দ সংরক্ষিত",
    retry: "পুনরায় চেষ্টা করুন",
    refresh_page: "রিফ্রেশ করুন",
    extension_updated: "এক্সটেনশন আপডেট হয়েছে, পৃষ্ঠা রিফ্রেশ করুন",
    account: "অ্যাকাউন্ট",
    sign_in: "সাইন ইন করুন",
    sign_in_google: "Google দিয়ে সাইন ইন করুন",
    sign_out: "সাইন আউট করুন",
    sync_now: "এখনই সিঙ্ক করুন",
    syncing: "সিঙ্ক হচ্ছে...",
    sync_success: "সিঙ্ক হয়েছে",
    logged_in_as: "হিসাবে লগ ইন",
    anonymous: "অতিথি",
    search_language: "ভাষা অনুসন্ধান করুন...",
    no_results: "কোন ফলাফল পাওয়া যায়নি",
    activity_title: "শেখার কার্যকলাপ",
    activity_last_weeks: "গত {weeks} সপ্তাহ",
    activity_selections: "টি নির্বাচন",
    activity_less: "কম",
    activity_more: "বেশি",
    show_activity: "কার্যকলাপ চার্ট দেখান",
    show_activity_sub: "শেখার অগ্রগতি হিটম্যাপ প্রদর্শন করুন",
  },
  pt: {
    word_selection: "Seleção de Palavras",
    word_selection_sub: "Traduzir e salvar palavras no YouTube",
    all_sites_selection: "Ativar em Todos os Sites",
    all_sites_selection_sub: "Usar seleção de palavras além do YouTube",
    view_words: "Minhas Palavras",
    view_words_sub: "Revisar e gerenciar palavras salvas",
    target_language: "Idioma Alvo",
    target_language_sub: "Idioma que você está aprendendo",
    my_language: "Meu Idioma",
    my_language_sub: "Seu idioma nativo",
    save_word: "Salvar",
    translation_loading: "Traduzindo...",
    translation_error: "Falha na tradução",
    word_saved: "Palavra salva",
    retry: "Tentar novamente",
    refresh_page: "Atualizar",
    extension_updated: "Extensão atualizada, por favor atualize a página",
    account: "Conta",
    sign_in: "Entrar",
    sign_in_google: "Entrar com Google",
    sign_out: "Sair",
    sync_now: "Sincronizar agora",
    syncing: "Sincronizando...",
    sync_success: "Sincronizado",
    logged_in_as: "Conectado como",
    anonymous: "Convidado",
    search_language: "Pesquisar idioma...",
    no_results: "Nenhum resultado encontrado",
    activity_title: "Atividade de Aprendizado",
    activity_last_weeks: "Últimas {weeks} semanas",
    activity_selections: "seleções",
    activity_less: "Menos",
    activity_more: "Mais",
    show_activity: "Mostrar Gráfico de Atividade",
    show_activity_sub: "Exibir mapa de calor de progresso",
  },
  ru: {
    word_selection: "Выбор Слов",
    word_selection_sub: "Переводите и сохраняйте слова на YouTube",
    all_sites_selection: "Включить на Всех Сайтах",
    all_sites_selection_sub: "Использовать выбор слов за пределами YouTube",
    view_words: "Мои Слова",
    view_words_sub: "Просмотр и управление сохранёнными словами",
    target_language: "Целевой Язык",
    target_language_sub: "Язык, который вы изучаете",
    my_language: "Мой Язык",
    my_language_sub: "Ваш родной язык",
    save_word: "Сохранить",
    translation_loading: "Перевод...",
    translation_error: "Ошибка перевода",
    word_saved: "Слово сохранено",
    retry: "Повторить",
    refresh_page: "Обновить",
    extension_updated: "Расширение обновлено, обновите страницу",
    account: "Аккаунт",
    sign_in: "Войти",
    sign_in_google: "Войти через Google",
    sign_out: "Выйти",
    sync_now: "Синхронизировать",
    syncing: "Синхронизация...",
    sync_success: "Синхронизировано",
    logged_in_as: "Вы вошли как",
    anonymous: "Гость",
    search_language: "Поиск языка...",
    no_results: "Результаты не найдены",
    activity_title: "Активность обучения",
    activity_last_weeks: "Последние {weeks} недель",
    activity_selections: "выборов",
    activity_less: "Меньше",
    activity_more: "Больше",
    show_activity: "Показать График Активности",
    show_activity_sub: "Показать тепловую карту прогресса",
  },
};

export const i18n = (
  key: keyof (typeof messages)["en"],
  paramsOrLanguage?: Record<string, string | number> | string,
  language?: string
) => {
  // Handle flexible signature: i18n(key, language?) or i18n(key, params, language?)
  let params: Record<string, string | number> | undefined;
  let lang: string;

  if (typeof paramsOrLanguage === "string") {
    // Called as i18n(key, language)
    params = undefined;
    lang = paramsOrLanguage.replace("-", "_");
  } else {
    // Called as i18n(key, params?, language?)
    params = paramsOrLanguage;
    lang = (language ?? navigator.language).replace("-", "_");
  }

  // Handle zh variants
  if (lang.startsWith("zh")) {
    if (lang.includes("TW") || lang.includes("HK")) {
      lang = "zh_TW";
    } else {
      lang = "zh_CN";
    }
  }

  let message: string;

  // @ts-ignore - Direct match
  if (messages[lang] && messages[lang][key]) {
    // @ts-ignore
    message = messages[lang][key];
  } else {
    // Fallback for sub-languages (e.g., en-GB -> en)
    const baseLang = lang.split("_")[0];
    // @ts-ignore
    if (messages[baseLang] && messages[baseLang][key]) {
      // @ts-ignore
      message = messages[baseLang][key];
    } else {
      message = messages["en"][key];
    }
  }

  // Replace {key} placeholders with params
  if (params) {
    return message.replace(/\{(\w+)\}/g, (_, k) =>
      String(params[k] ?? `{${k}}`)
    );
  }

  return message;
};
